---
title: Container Service
description: Deploy containerized applications using Fargate and ALB
---

import { Icon } from 'astro-icon/components';

Deploy containerized web services on AWS Fargate with Application Load Balancer for scalable, managed container hosting.

Thunder provides the [@thunderso/cdk-webservice](https://github.com/thunder-so/cdk-webservice) package for deploying Docker containers to ECS Fargate with automatic VPC creation, load balancing, and support for Nixpacks to build containers without writing Dockerfiles.

## Supported Frameworks

- [Next.js](https://nextjs.org/)
- [Nuxt](https://nuxt.com/)
- [TanStack Stack](https://tanstack.com/start/latest)
- [SvelteKit](https://kit.svelte.dev/)
- [Astro](https://astro.build/)
- [NestJS](https://nestjs.com/)
- [Fastify](https://www.fastify.io/)
- Any containerized web application

## Container Service Architecture

The container service architecture provides scalable, managed container hosting with load balancing and high availability.

<section class="max-w-full bg-card border border-border rounded-lg p-6 mb-6">
  <svg viewBox="0 0 720 130" class="w-full h-auto">
    <line x1="120" y1="60" x2="200" y2="60" stroke="currentColor" class="text-border" />
    <line x1="320" y1="60" x2="400" y2="60" stroke="currentColor" class="text-border" />
    <line x1="520" y1="60" x2="600" y2="60" stroke="currentColor" class="text-border" />
    
    <foreignObject x="0" y="30" width="120" height="80">
      <div class="flex flex-col items-center text-center">
        <div class="w-8 h-8 text-gray-600">
          <Icon name="tabler:users" class="text-muted-foreground w-full h-full" />
        </div>
        <span class="mt-2 text-sm font-medium text-muted-foreground">Users</span>
      </div>
    </foreignObject>
    
    <foreignObject x="200" y="20" width="120" height="80">
      <div class="flex flex-col items-center text-center">
        <div class="w-12 h-12 text-orange-500">
          <Icon name="logos:aws-route53" class="w-full h-full" />
        </div>
        <span class="mt-2 text-sm font-medium text-muted-foreground">Route 53</span>
      </div>
    </foreignObject>
    
    <foreignObject x="400" y="20" width="120" height="100">
      <div class="flex flex-col items-center text-center">
        <div class="w-12 h-12">
          <svg class="w-full h-full" viewBox="0 0 80 80">
            <defs>
              <linearGradient x1="0%" y1="100%" x2="100%" y2="0%" id="linearGradient-alb">
                <stop stop-color="#4D27A8" offset="0%"></stop>
                <stop stop-color="#A166FF" offset="100%"></stop>
              </linearGradient>
            </defs>
            <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
              <rect fill="url(#linearGradient-alb)" x="0" y="0" width="80" height="80"></rect>
              <path d="M30,53 C22.832,53 17,47.168 17,40 C17,32.832 22.832,27 30,27 C37.168,27 43,32.832 43,40 C43,47.168 37.168,53 30,53 M60,59 C60,61.206 58.206,63 56,63 C53.794,63 52,61.206 52,59 C52,56.794 53.794,55 56,55 C58.206,55 60,56.794 60,59 M56,17 C58.206,17 60,18.794 60,21 C60,23.206 58.206,25 56,25 C53.794,25 52,23.206 52,21 C52,18.794 53.794,17 56,17 M59,36 C61.206,36 63,37.794 63,40 C63,42.206 61.206,44 59,44 C56.794,44 55,42.206 55,40 C55,37.794 56.794,36 59,36 M44.949,41 L53.09,41 C53.568,43.833 56.033,46 59,46 C62.309,46 65,43.309 65,40 C65,36.691 62.309,34 59,34 C56.033,34 53.568,36.167 53.09,39 L44.949,39 C44.823,37.099 44.344,35.297 43.572,33.654 L52.446,25.823 C53.442,26.559 54.669,27 56,27 C59.309,27 62,24.309 62,21 C62,17.691 59.309,15 56,15 C52.691,15 50,17.691 50,21 C50,22.256 50.389,23.421 51.051,24.386 L42.581,31.859 C39.904,27.738 35.271,25 30,25 C21.729,25 15,31.729 15,40 C15,48.271 21.729,55 30,55 C35.271,55 39.904,52.262 42.581,48.141 L51.051,55.614 C50.389,56.579 50,57.744 50,59 C50,62.309 52.691,65 56,65 C59.309,65 62,62.309 62,59 C62,55.691 59.309,53 56,53 C54.669,53 53.442,53.441 52.446,54.177 L43.572,46.346 C44.344,44.703 44.823,42.901 44.949,41" fill="#FFFFFF"></path>
            </g>
          </svg>
        </div>
        <span class="mt-2 text-sm font-medium text-muted-foreground">Application Load Balancer</span>
      </div>
    </foreignObject>
    
    <foreignObject x="600" y="20" width="120" height="80">
      <div class="flex flex-col items-center text-center">
        <div class="w-12 h-12 text-orange-600">
          <Icon name="logos:aws-fargate" class="w-full h-full" />
        </div>
        <span class="mt-2 text-sm font-medium text-muted-foreground">Fargate</span>
      </div>
    </foreignObject>
  </svg>
</section>

**Route 53** handles DNS resolution for custom domains. **Application Load Balancer** distributes incoming traffic across multiple container instances with health checks and SSL termination. **Fargate** runs containerized applications without managing servers, providing automatic scaling and high availability.

## Container Deployment Pipeline

The container deployment pipeline builds Docker images and deploys them to managed container infrastructure.

<section class="max-w-full bg-card border border-border rounded-lg p-6 mb-6">
  <svg viewBox="0 0 720 260" class="w-full h-auto">
    <line x1="120" y1="60" x2="200" y2="60" stroke="currentColor" class="text-border" />
    <line x1="320" y1="60" x2="400" y2="60" stroke="currentColor" class="text-border" />
    <line x1="520" y1="60" x2="600" y2="60" stroke="currentColor" class="text-border" />
    <line x1="660" y1="120" x2="660" y2="160" stroke="currentColor" class="text-border" />
    
    <foreignObject x="0" y="30" width="120" height="80">
      <div class="flex flex-col items-center text-center">
        <div class="w-8 h-8">
          <Icon name="tabler:brand-github" class="text-muted-foreground w-full h-full" />
        </div>
        <span class="mt-2 text-sm font-medium text-muted-foreground">GitHub</span>
      </div>
    </foreignObject>
    
    <foreignObject x="200" y="20" width="120" height="80">
      <div class="flex flex-col items-center text-center">
        <div class="w-12 h-12">
          <Icon name="logos:aws-codepipeline" class="w-full h-full" />
        </div>
        <span class="mt-2 text-sm font-medium text-muted-foreground">CodePipeline</span>
      </div>
    </foreignObject>
    
    <foreignObject x="400" y="20" width="120" height="80">
      <div class="flex flex-col items-center text-center">
        <div class="w-12 h-12">
          <Icon name="logos:aws-codebuild" class="w-full h-full" />
        </div>
        <span class="mt-2 text-sm font-medium text-muted-foreground">CodeBuild</span>
      </div>
    </foreignObject>
    
    <foreignObject x="600" y="20" width="120" height="80">
      <div class="flex flex-col items-center text-center">
        <div class="w-12 h-12">
            <svg class="w-full h-full" viewBox="0 0 80 80">
                <defs>
                    <linearGradient x1="0%" y1="100%" x2="100%" y2="0%" id="linearGradient-ecr">
                        <stop stop-color="#C8511B" offset="0%"></stop>
                        <stop stop-color="#FF9900" offset="100%"></stop>
                    </linearGradient>
                </defs>
                <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                    <rect fill="url(#linearGradient-ecr)" x="0" y="0" width="80" height="80"></rect>
                    <path d="M38.7880741,37.5776945 C38.2933845,37.8655125 37.9855777,38.4000317 37.9855777,38.973662 L37.9855777,66.7195186 L16.9987459,54.9841655 L16.9987459,27.7076428 L40.5569643,14.0588515 L61.484833,24.4283226 L38.7880741,37.5776945 Z M63.9203049,24.4022485 C63.9203049,23.8276153 63.6134974,23.2920933 63.0598448,22.9751927 L41.3464689,12.2146099 C40.8507799,11.9287976 40.2351662,11.9277948 39.7404766,12.2156128 L15.8024965,26.0840283 C15.3078069,26.3718463 15,26.9063655 15,27.4799958 L15,55.2158239 C15,55.7894542 15.3078069,56.3239734 15.8174871,56.6198142 L37.573836,68.7853901 C37.8216805,68.9287976 38.1005056,69 38.3783312,69 C38.6551575,69 38.9339826,68.9287976 39.1808277,68.7853901 C39.6765167,68.4985749 39.9843236,67.9640557 39.9843236,67.3894226 L39.9843236,39.201309 L63.1178084,25.798216 C63.6134974,25.5114008 63.9203049,24.9768817 63.9203049,24.4022485 L63.9203049,24.4022485 Z M63.9692742,55.0473451 L44.9811883,66.6613533 L44.9811883,56.2617967 L54.881976,49.872638 L54.9499334,49.424364 C54.9679221,49.3070305 54.9749177,49.3070305 54.9749177,48.7664942 L55.0058983,36.3602344 L64.0002547,31.1484218 L63.9692742,55.0473451 Z M65.1965042,29.0715191 C64.6998158,28.7816953 64.0842021,28.7826982 63.5885131,29.0715191 L54.0135209,34.6182835 C53.713709,34.7817481 53.0081517,35.1658398 53.0081517,35.9580914 L52.9761718,48.7173546 L43.8508975,54.606091 C43.3062392,54.9310145 42.9824424,55.4454766 42.9824424,55.9890214 L42.9824424,67.3081917 C42.9824424,67.8748021 43.2872511,68.3912699 43.7979307,68.6871107 C44.0647633,68.8405468 44.361577,68.9187691 44.6573914,68.9187691 C44.948209,68.9187691 45.2390265,68.8445582 45.5018616,68.692125 L65.1675223,56.6639396 C65.6622119,56.3761216 65.9680201,55.8416024 65.9680201,55.2709807 L66,30.4664837 C66,29.8928534 65.6921931,29.3583342 65.1965042,29.0715191 L65.1965042,29.0715191 Z" fill="#FFFFFF"></path>
                </g>
            </svg>
        </div>
        <span class="mt-2 text-sm font-medium text-muted-foreground">ECR</span>
      </div>
    </foreignObject>
    
    <foreignObject x="600" y="180" width="120" height="80">
      <div class="flex flex-col items-center text-center">
        <div class="w-12 h-12 text-orange-600">
          <Icon name="logos:aws-fargate" class="w-full h-full" />
        </div>
        <span class="mt-2 text-sm font-medium text-muted-foreground">Fargate</span>
      </div>
    </foreignObject>
  </svg>
</section>

**GitHub** triggers deployments on code changes. **CodePipeline** orchestrates the workflow while **CodeBuild** builds Docker images and pushes to **ECR**. **Fargate** pulls the latest images and deploys containers with zero-downtime rolling updates.

## Quick Start

Deploy your containerized application to AWS Fargate with automatic infrastructure provisioning. This guide covers installation, configuration, and deployment.

### Installation

```bash
bun add -D tsx @thunderso/cdk-webservice
```

### Basic Setup

```bash
mkdir stack && touch stack/index.ts
```

### Configuration

```ts
// stack/index.ts
import { Cdk, WebServiceStack, type WebServiceProps } from "@thunderso/cdk-webservice";

const svcProps: WebServiceProps = {
  env: {
    account: 'your-account-id',
    region: 'us-west-2'
  },
  application: 'my-app',
  service: 'web',
  environment: 'production',
};

new WebServiceStack(
  new Cdk.App(), 
  `${svcProps.application}-${svcProps.service}-${svcProps.environment}-stack`, 
  svcProps
);
```

### Deploy

```bash
bunx cdk deploy --all --app="bunx tsx stack/index.ts"
```

## Custom Domain Setup

Connect your service to a custom domain using Route 53 and ACM certificates. The certificate must be issued in the same region as your Fargate service.

```ts
const svcProps: WebServiceProps = {
  // ... other props
  domain: 'app.example.com',
  hostedZoneId: 'Z1D633PJN98FT9',
  regionalCertificateArn: 'arn:aws:acm:us-west-2:123456789012:certificate/abcd1234-abcd-1234-abcd-1234abcd1234',
};
```

## Service Configuration

### Container Settings

Configure CPU, memory, desired task count, and container port. Supports ARM64 architecture for better price-performance with Graviton processors.

```ts
import { CpuArchitecture } from 'aws-cdk-lib/aws-ecs';

const svcProps: WebServiceProps = {
  // ... other props
  serviceProps: {
    dockerFile: 'Dockerfile',
    architecture: CpuArchitecture.ARM64,
    desiredCount: 2,
    cpu: 512,
    memorySize: 1024,
    port: 3000,
  },
};
```

### Environment Variables

Manage configuration with plain environment variables and secure secrets from AWS Secrets Manager. The library automatically grants ECS tasks permissions to read specified secrets.

```ts
const svcProps: WebServiceProps = {
  // ... other props
  serviceProps: {
    variables: [
      { NODE_ENV: 'production' },
      { PUBLIC_API_URL: 'https://api.example.com' }
    ],
    secrets: [
      { 
        key: 'DATABASE_URL', 
        resource: 'arn:aws:secretsmanager:us-west-2:123456789012:secret:db-url-abc123' 
      }
    ],
  },
};
```

## Nixpacks Integration

Use [Nixpacks](https://nixpacks.com/) to automatically generate Dockerfiles and build containers without manual configuration. Nixpacks detects your framework and creates optimized builds for Node.js, Python, Go, Rust, and more.

```ts
const svcProps: WebServiceProps = {
  // ... other props
  buildProps: {
    buildSystem: 'Nixpacks',
    installcmd: 'bun install',
    buildcmd: 'bun run build',
    startcmd: 'bun start',
    environment: [
      { NODE_ENV: 'production' }
    ],
  },
};
```

## Docker Example

Manually define your container build process with a custom Dockerfile. 

```dockerfile
# Dockerfile
FROM public.ecr.aws/docker/library/alpine AS builder

ENV NODE_ENV=production

# Install Bun
RUN curl -fsSL https://bun.sh/install | bash

# Update PATH for bun
ENV PATH="/root/.bun/bin:$PATH"

# Copy code, install and build
WORKDIR /app
COPY . .
RUN bun install
RUN bun run build

EXPOSE 3000
CMD ["bun", "start"]
```