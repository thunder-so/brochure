---
import { Astronav, MenuItems, MenuIcon } from "astro-navbar";
// import Brand from './public/thunder.svg';
import Button from './Button.astro';
import Brand from './Brand.astro';

const { class: additionalClass } = Astro.props;

const menuitems = [
  {
    title: "Docs",
    path: "/docs",
  },
  // {
  //   title: "Blog",
  //   path: "/blog",
  // },
  {
    title: "Pricing",
    path: "#pricing",
  },
];

let isAuthenticated = false;

---

<header id="header" class:list={[additionalClass, "navigation"]}>
<div class="mx-auto px-5 py-3">
  <Astronav>
    <div class="flex flex-col lg:flex-row lg:justify-between">
        <div class="flex items-center justify-between">
          <Brand />

          <div class="flex lg:hidden">
            <MenuIcon class="w-4 h-4" />
          </div>
        </div>
      
        <MenuItems class="hidden mt-2 lg:flex lg:items-center lg:mt-0">
          <ul class="flex flex-col lg:flex-row lg:gap-3 lg:mr-4 font-md">
            {
              menuitems.map((item, index) => (
                <>
                    <li>
                      <a
                        href={item.path}
                        class="flex lg:px-3 py-2 items-center">
                        <span> {item.title}</span>
                      </a>
                    </li>
                </>
              ))
            }
          </ul>

          <div class="flex items-center gap-3 mr-6">
            <!-- <a href="https://discord.gg/nZwr6c5c6v" aria-label="Discord" target="_blank" rel="noopener noreferrer">
              <svg class="w-5 h-5" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 24 24">
                <path d="M20.317 4.369a19.791 19.791 0 0 0-4.885-1.515.074.074 0 0 0-.079.037c-.211.375-.444.864-.608 1.249a18.365 18.365 0 0 0-5.518 0 12.505 12.505 0 0 0-.617-1.249.077.077 0 0 0-.079-.037 19.736 19.736 0 0 0-4.885 1.515.069.069 0 0 0-.032.027C.533 9.045-.32 13.579.099 18.057a.082.082 0 0 0 .031.056 19.9 19.9 0 0 0 5.993 3.03.077.077 0 0 0 .084-.027c.462-.63.874-1.295 1.226-1.994a.076.076 0 0 0-.041-.105 13.13 13.13 0 0 1-1.872-.9.077.077 0 0 1-.008-.127c.126-.094.252-.192.373-.291a.075.075 0 0 1 .077-.01c3.927 1.793 8.18 1.793 12.062 0a.075.075 0 0 1 .079.008c.121.099.247.197.373.291a.077.077 0 0 1-.006.127 12.432 12.432 0 0 1-1.873.899.076.076 0 0 0-.04.106c.36.698.772 1.363 1.226 1.993a.076.076 0 0 0 .084.028 19.876 19.876 0 0 0 6.002-3.03.076.076 0 0 0 .031-.056c.5-5.177-.838-9.657-3.549-13.661a.061.061 0 0 0-.031-.028ZM8.02 15.331c-1.183 0-2.156-1.085-2.156-2.419 0-1.333.955-2.419 2.156-2.419 1.21 0 2.183 1.086 2.156 2.419 0 1.334-.955 2.419-2.156 2.419Zm7.96 0c-1.183 0-2.156-1.085-2.156-2.419 0-1.333.955-2.419 2.156-2.419 1.21 0 2.183 1.086 2.156 2.419 0 1.334-.946 2.419-2.156 2.419Z"/>
              </svg>
            </a> -->
            <a href="https://github.com/thunder-so/" aria-label="GitHub" target="_blank" rel="noopener noreferrer">
              <svg class="w-5 h-5" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 24 24">
                <path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.387.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61-.546-1.387-1.333-1.757-1.333-1.757-1.09-.744.084-.729.084-.729 1.205.084 1.84 1.236 1.84 1.236 1.07 1.835 2.807 1.305 3.492.998.108-.775.418-1.305.762-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.382 1.235-3.222-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23a11.52 11.52 0 0 1 3-.405c1.02.005 2.045.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.912 1.23 3.222 0 4.61-2.805 5.625-5.475 5.92.435.375.81 1.102.81 2.222 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/>
              </svg>
            </a>
            <!-- <a href="https://twitter.com/_thunderso" aria-label="Twitter" target="_blank" rel="noopener noreferrer">
              <svg class="w-5 h-5" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 24 24">
                <path d="M24 4.557a9.83 9.83 0 0 1-2.828.775 4.932 4.932 0 0 0 2.165-2.724 9.864 9.864 0 0 1-3.127 1.195 4.916 4.916 0 0 0-8.384 4.482A13.944 13.944 0 0 1 1.671 3.149a4.916 4.916 0 0 0 1.523 6.573 4.903 4.903 0 0 1-2.229-.616c-.054 2.281 1.581 4.415 3.949 4.89a4.935 4.935 0 0 1-2.224.084 4.918 4.918 0 0 0 4.6 3.417 9.867 9.867 0 0 1-6.102 2.104c-.396 0-.788-.023-1.175-.068a13.945 13.945 0 0 0 7.548 2.212c9.057 0 14.01-7.514 14.01-14.01 0-.213-.005-.425-.014-.636A10.025 10.025 0 0 0 24 4.557z"/>
              </svg>
            </a> -->
          </div>

          <div class="flex my-2 lg:my-0 items-center gap-2">
            <Button size="sm" variant="secondary" data-auth-button>Log In</Button>
            <Button size="sm" variant="primary" data-auth-button>Sign Up</Button>
          </div>

          <!-- <div 
            x-data="{ isAuthenticated: false }" 
            x-init="isAuthenticated = document.cookie.includes('active-organization-id')" 
            class="flex my-2 lg:my-0 items-center gap-2">
              <template x-if="!isAuthenticated">
                <div>
                  <Button size="sm" variant="secondary" data-auth-button>Log In</Button>
                  <Button size="sm" variant="primary" data-auth-button>Sign Up</Button>
                </div>
              </template>
              <template x-if="isAuthenticated">
                <a href="https://console.thunder.so">
                  <Button size="sm" variant="primary">Go to console</Button>
                </a>
              </template>
          </div> -->
        </MenuItems>
    </div>
  </Astronav>
</div>
</header>

<script>
// import { supabase } from "../lib/supabase";

async function signInWithGithub() {
  // console.log("clicked");
  // const { data, error } = await supabase.auth.signInWithOAuth({
  //   provider: 'github',
  //   options: {
  //       scopes: '',
  //       redirectTo: `https://sandbox.thunder.so/confirm`
  //   }
  // })

  window.location.href = '/api/login';
}

const buttons = document.querySelectorAll('[data-auth-button]');

buttons.forEach(button => {
  button.addEventListener('click', signInWithGithub);
});
</script>

<!-- <script>
  if (typeof window !== 'undefined') {
    let isAuthenticated = false;

    // Check if the cookie exists
    const cookieName = 'active-organization-id';
    const cookies = document.cookie.split('; ').reduce((acc, cookieStr) => {
      const [name, value] = cookieStr.split('=');
      acc[name] = value;
      return acc;
    }, {});

    isAuthenticated = cookies.hasOwnProperty(cookieName);
    console.log(isAuthenticated)
  }
</script> -->


<script>
  if (typeof window !== 'undefined') {
    window.addEventListener('scroll', () => {
      const header = document.getElementById('header');
      if (header) { 
        if (window.scrollY > 50) {
          header.classList.add('scrolled');
        } else {
          header.classList.remove('scrolled');
        }
      }
    });
  }
</script>

<style>
header.navigation {
  position: fixed;
  top: 0px;
  left: 0;
  z-index: 999;
  width: 100%;
  transition: background-color 0.25s;
  font-family: var(--font-family-heading);
  text-rendering: optimizeLegibility;
  border-bottom: 1px solid transparent;
}

header.documentation,
header.scrolled {
  border-bottom: 1px solid var(--border);
  background-color: var(--bg);
}

@media (max-width: 1024px) {
  header.navigation {
    background-color: var(--bg);
    border-bottom: 1px solid transparent;
  }
}


header.navigation a:hover {
  text-decoration: none;
}
</style>