---
import { ChevronDown, Menu, X } from "lucide-astro";
import Button from "../Button.astro";
import ProductMegamenu from "./ProductMegamenu.astro";
---

<header class="fixed top-0 left-0 right-0 z-50 border-b border-border/50 bg-background/80 backdrop-blur-xl">
  <div class="mx-auto px-4">
    <nav class="flex h-16 items-center justify-between">
      {/* Logo */}
      <a href="/" class="flex items-center gap-2">
        <img src="/images/thunder.svg" alt="Thunder" class="h-6 w-6" />
        <span class="text-md font-bold text-foreground">Thunder</span>
      </a>

      {/* Desktop Navigation */}
      <div class="hidden lg:flex items-center gap-1">
        {/* Product Dropdown */}
        <div class="relative group">
          <button
            class="flex items-center gap-1 px-4 py-2 text-sm text-muted-foreground hover:text-foreground transition-colors"
          >
            Product
            <ChevronDown class="h-4 w-4" />
          </button>
          <ProductMegamenu />
        </div>

        <a href="/pricing" class="px-4 py-2 text-sm text-muted-foreground hover:text-foreground transition-colors">
          Pricing
        </a>
        <a href="/docs" class="px-4 py-2 text-sm text-muted-foreground hover:text-foreground transition-colors">
          Docs
        </a>
        <a href="/blog" class="px-4 py-2 text-sm text-muted-foreground hover:text-foreground transition-colors">
          Blog
        </a>
        <a href="/docs/support" class="px-4 py-2 text-sm text-muted-foreground hover:text-foreground transition-colors">
          Support
        </a>
      </div>

      {/* Desktop CTAs */}
      <div class="hidden lg:flex items-center gap-3">
        <Button variant="ghost" href="/api/login" data-auth-button>Log in</Button>
        <Button variant="hero" href="/api/login" data-auth-button>Sign Up</Button>
      </div>

      {/* Mobile Menu Button */}
      <button
        id="mobile-menu-toggle"
        class="lg:hidden p-2 text-foreground"
        aria-label="Toggle Menu"
      >
        <Menu class="h-6 w-6 block" id="menu-icon" />
        <X class="h-6 w-6 hidden" id="close-icon" />
      </button>
    </nav>
  </div>

  {/* Mobile Menu */}
  <div id="mobile-menu" class="hidden lg:hidden border-t border-border bg-background">
    <div class="container mx-auto px-4 py-6 space-y-6">
      {/* Product Section */}
      <div class="space-y-2">
        <div class="text-xs font-semibold text-muted-foreground uppercase tracking-wider">Product</div>
        <ProductMegamenu isMobile={true} />
      </div>
      <div class="h-px bg-border" />
      <a href="/pricing" class="block py-2 text-foreground hover:text-primary transition-colors">
        Pricing
      </a>
      <a href="/docs" class="block py-2 text-foreground hover:text-primary transition-colors">
        Docs
      </a>
      <a href="/blog" class="block py-2 text-foreground hover:text-primary transition-colors">
        Blog
      </a>
      <div class="h-px bg-border" />
      <div class="flex gap-3 pt-2">
        <Button variant="outline" class="flex-1" href="/api/login" data-auth-button>Log in</Button>
        <Button variant="hero" class="flex-1" href="/api/login" data-auth-button>Sign Up</Button>
      </div>
    </div>
  </div>
</header>

<script>
  const toggle = document.getElementById('mobile-menu-toggle');
  const menu = document.getElementById('mobile-menu');
  const menuIcon = document.getElementById('menu-icon');
  const closeIcon = document.getElementById('close-icon');

  toggle?.addEventListener('click', () => {
    menu?.classList.toggle('hidden');
    menuIcon?.classList.toggle('hidden');
    closeIcon?.classList.toggle('hidden');
  });
</script>